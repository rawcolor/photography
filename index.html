<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Raw Color Photography – Portrait</title>
  <style>
    :root{
      --bg:#0a0a0a;--bg-2:#111;--text:#d6d6d6;--muted:#9a9a9a;--accent:#7fd1b9;--max:1200px;
      --gap:14px;            /* grid gap, keep in sync with JS */
      --row:8px;             /* base row height unit, keep in sync with JS */
      --tile-radius:10px;
      --min-portrait:320px;  /* min visual height for portrait images */
    }
    @media (max-width:700px){
      :root{ --min-portrait:260px; }
    }

    *{box-sizing:border-box}
    html,body{
      margin:0;padding:0;background:var(--bg);color:var(--text);
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Helvetica,Arial,sans-serif
    }
    a{color:inherit;text-decoration:none}

    /* Header */
    .site-header{
      position:sticky;top:0;z-index:50;
      backdrop-filter:saturate(1.2) blur(4px);
      background:rgba(10,10,10,.85);
      border-bottom:1px solid #1e1e1e
    }
    .header-wrap{
      max-width:var(--max);margin:0 auto;display:flex;align-items:center;justify-content:space-between;
      padding:16px 20px
    }
    .brand{font-size:clamp(18px,2.3vw,28px);font-weight:600;letter-spacing:.2px;white-space:nowrap}
    nav ul{display:flex;gap:22px;list-style:none;margin:0;padding:0;align-items:center}
    nav a{color:var(--muted);font-size:14px;letter-spacing:.4px;padding:6px 0;border-bottom:2px solid transparent;transition:color .15s,border-color .15s}
    nav a:hover{color:var(--text)} nav a.active{color:var(--text);border-bottom-color:var(--accent)}
    .icon{display:inline-flex;width:18px;height:18px;vertical-align:middle;opacity:.9}

    .section{max-width:var(--max);margin:0 auto;padding:28px 20px 56px}

    /* Masonry via CSS Grid + measured row spans */
    .grid{
      display:grid;
      grid-template-columns:repeat(auto-fill, minmax(230px, 1fr));
      grid-auto-rows:var(--row);
      gap:var(--gap);
    }

    .tile{
      display:block;
      background:var(--bg-2);
      border:1px solid #1a1a1a;
      border-radius:var(--tile-radius);
      overflow:hidden;
      box-shadow:0 2px 6px rgba(0,0,0,.25);
      transition:transform .2s;
    }
    .tile:hover{ transform:translateY(-2px) }
    .tile img{ display:block; width:100%; height:auto; }

    /* Landscape images span 2 columns (when there’s room) */
    .tile.wide{ grid-column:span 2; }
    @media (max-width: 700px){
      .tile.wide{ grid-column:auto; }
    }

    /* When we enforce a min height, fill the tile (no empty bottom space) */
    .tile.fill img{
      height:100%;
      width:100%;
      object-fit:cover;      /* crops if needed to fill the tile */
    }

    /* Group divider (no headings) */
    .group + .group{
      margin-top:28px; padding-top:10px; position:relative;
    }
    .group + .group::before{
      content:""; position:absolute; left:0; right:0; top:0; height:1px;
      background:linear-gradient(to right, transparent, #222 18%, #222 82%, transparent);
    }

    footer{border-top:1px solid #1e1e1e;color:var(--muted);text-align:center;padding:24px 16px 40px;font-size:13px}
  </style>
</head>
<body>
  <header class="site-header" role="banner">
    <div class="header-wrap">
      <div class="brand">Raw Color Photography</div>
      <nav aria-label="Primary">
        <ul>
          <li><a href="index.html" class="active">Portrait</a></li>
          <li><a href="food.html">Food</a></li>
          <li><a href="nude.html">Nude</a></li>
          <li><a href="mailto:hello@example.com">Contacts</a></li>
          <li>
            <a href="https://instagram.com/" target="_blank" rel="noopener" aria-label="Instagram">
              <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                <rect x="3" y="3" width="18" height="18" rx="5"></rect>
                <path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"></path>
                <line x1="17.5" y1="6.5" x2="17.5" y2="6.5"></line>
              </svg>
            </a>
          </li>
        </ul>
      </nav>
    </div>
  </header>

  <section class="section" id="gallery"></section>

  <footer>&copy; <span id="y"></span> Raw Color Photography</footer>

  <script>
    document.getElementById('y').textContent = new Date().getFullYear();

    const files = [
      "A1.jpg","A2.jpg","A3.jpg","A4.jpg","A5.jpg","A6.jpg",
      "B1.jpg","B2.jpg","B3.jpg",
      "C1.jpg","C2.jpg","C3.jpg","C4.jpg",
      "D1.jpg","D2.jpg",
      "E1.jpg","E2.jpg","E3.jpg","E4.jpg",
      "F1.jpg","F2.jpg",
      "G1.jpg","G2.jpg","G3.jpg","G4.jpg","G5.jpg",
      "H1.jpg"
    ];

    function niceAlt(n){
      return n.replace(/\.[^.]+$/,'').replace(/[-_]+/g,' ').replace(/\s+/g,' ').trim();
    }

    // Group by first letter
    const byLetter = {};
    files.forEach(n => {
      const k = n[0].toUpperCase();
      (byLetter[k] ||= []).push(n);
    });

    const gallery = document.getElementById('gallery');

    // Create an image tile and append to grid
    function appendTile(grid, name){
      const a = document.createElement('a');
      a.className = 'tile';
      a.href = "portrait/" + encodeURIComponent(name);
      a.target = "_blank";

      const img = document.createElement('img');
      img.loading = 'lazy';
      img.decoding = 'async';
      img.alt = niceAlt(name);
      img.src = "portrait/" + encodeURIComponent(name);

      img.onload = () => {
        // Mark landscapes to span 2 columns
        if (img.naturalWidth > img.naturalHeight) {
          a.classList.add('wide');
        }
        sizeTile(a, img, grid);
      };

      a.appendChild(img);
      grid.appendChild(a);
    }

    // Measure & set grid row span; enforce min height for portraits and fill the tile
    function sizeTile(tile, img, grid){
      const styles = getComputedStyle(document.documentElement);
      const minPortrait = parseFloat(styles.getPropertyValue('--min-portrait')) || 320;

      const gap = parseFloat(getComputedStyle(grid).getPropertyValue('--gap')) || 14;
      const row = parseFloat(getComputedStyle(grid).getPropertyValue('--row')) || 8;

      // current rendered image height at width:100%
      let h = img.getBoundingClientRect().height || img.naturalHeight || 0;

      let clamped = false;
      const isPortrait = img.naturalHeight >= img.naturalWidth;
      if (isPortrait && h < minPortrait) {
        h = minPortrait;     // make tile taller
        clamped = true;      // and fill it with cover
      }

      const rows = Math.max(1, Math.ceil((h + gap) / (row + gap)));
      tile.style.gridRowEnd = `span ${rows}`;

      // Toggle fill mode (prevents empty space by cropping to fill)
      if (clamped) {
        tile.classList.add('fill');
      } else {
        tile.classList.remove('fill');
      }
    }

    // Re-measure on resize (debounced)
    let resizeTimer;
    window.addEventListener('resize', () => {
      clearTimeout(resizeTimer);
      resizeTimer = setTimeout(() => {
        document.querySelectorAll('.group .grid').forEach(grid => {
          grid.querySelectorAll('.tile').forEach(tile => {
            const img = tile.querySelector('img');
            if (img && img.complete) sizeTile(tile, img, grid);
          });
        });
      }, 120);
    });

    // Render each group with subtle divider
    Object.keys(byLetter).sort().forEach(k => {
      const group = document.createElement('div');
      group.className = 'group';

      const grid = document.createElement('div');
      grid.className = 'grid';

      byLetter[k].forEach(name => appendTile(grid, name));

      group.appendChild(grid);
      gallery.appendChild(group);
    });
  </script>
</body>
</html>
